#include <cstdint>
#include <iostream>
#include <vector>

class Perceptron
{
private:
    std::vector<float> weights;
    float bias;
    int num_features;

public:
    Perceptron()
    {
        weights = {1343.0, 1568.0, 1654.0, 1468.0, 1301.0, 1415.0, 1686.0, 1466.0, 2317.0,
                   1894.0, 1854.0, 1567.0, 1342.0, 1433.0, 642.0, 429.0, 1140.0, 1117.0, 230.0,
                   64.0, 600.0, 1067.0, 1082.0, 420.0, 887.0, 634.0, 477.0, -297.0, -389.0,
                   -911.0, -411.0, -209.0, 276.0, 112.0, 27.0, 327.0, 388.0, 309.0, 133.0,
                   61.0, 296.0, 363.0, 239.0, 405.0, 261.0, 425.0, 214.0, 163.0, 210.0, -104.0,
                   -197.0, 4.0, -571.0, 397.0, -377.0, -5.0, -135.0, -155.0, 1.0, -128.0,
                   612.0, -347.0, -164.0, -235.0, -30.0, -385.0, 143.0, -691.0, -274.0, 69.0,
                   -447.0, 444.0, -47.0, -376.0, 143.0, 1048.0, 369.0, 113.0, 370.0, 635.0,
                   757.0, -182.0, 350.0, 308.0, -177.0, 220.0, 507.0, 233.0, 246.0, 343.0,
                   359.0, -49.0, 358.0, 587.0, 2.0, -137.0, 250.0, 535.0, 993.0, 65.0, 248.0,
                   -322.0, 479.0, 323.0, 355.0, 598.0, 293.0, 64.0, 85.0, 276.0, 317.0, 244.0,
                   -285.0, -102.0, 236.0, 38.0, -205.0, -27.0, -22.0, 357.0, 478.0, 754.0,
                   780.0, 152.0, 670.0, 297.0, 355.0, 666.0, 202.0, 405.0, 645.0, 887.0, 608.0,
                   1121.0, -117.0, 85.0, 49.0, -49.0, 367.0, 100.0, 148.0, 313.0, 735.0, 129.0,
                   256.0, -70.0, 413.0, 1060.0, 876.0, 1140.0, 1466.0, 1315.0, 1566.0, 1394.0,
                   907.0, 922.0, 1453.0, 1347.0, 933.0, 317.0, 539.0, 289.0, 429.0, 469.0,
                   488.0, 865.0, 1126.0, 493.0, 802.0, 1063.0, 1270.0, 1370.0, 776.0, 1290.0,
                   1488.0, 990.0, 963.0, 1012.0, 800.0, 526.0, 791.0, 363.0, 227.0, -307.0,
                   349.0, 405.0, 139.0, 133.0, 92.0, 387.0, 122.0, -177.0, 409.0, 250.0, 569.0,
                   342.0, 367.0, 612.0, 101.0, 578.0, 324.0, 879.0, 1397.0, 1156.0, 921.0,
                   1165.0, 905.0, 415.0, 627.0, 447.0, 367.0, 320.0, 31.0, 424.0, -361.0,
                   289.0, -32.0, 33.0, -90.0, 776.0, 820.0, 482.0, 594.0, 206.0, 660.0, 567.0,
                   733.0, 401.0, 566.0, 776.0, 311.0, 830.0, 858.0, 636.0, 207.0, 527.0, 265.0,
                   701.0, 272.0, 670.0, 450.0, -347.0, -128.0, 168.0, 264.0, -3.0, -123.0,
                   -138.0, -542.0, -890.0, -824.0, -478.0, -947.0, -1176.0, -499.0, -722.0,
                   -539.0, -945.0, -369.0, -25.0, -317.0, -381.0, -100.0, 55.0, -177.0, -81.0,
                   -30.0, 401.0, 375.0, 2.0, 454.0, -447.0, -16.0, -860.0, -70.0, 7.0, -916.0,
                   74.0, 371.0, -425.0, -45.0, -641.0, -446.0, -835.0, -551.0, -690.0, -829.0,
                   81.0, 123.0, 257.0, -36.0, 956.0, 683.0, 914.0, 768.0, 883.0, 451.0, 491.0,
                   894.0, 1037.0, 771.0, 609.0, 553.0, 561.0, 795.0, 503.0, 232.0, 289.0,
                   378.0, 132.0, 209.0, 153.0, 646.0, 92.0, 270.0, 869.0, 493.0, 41.0, 825.0,
                   -13.0, 829.0, 998.0, 869.0, 834.0, 764.0, 914.0, 1095.0, 1009.0, 953.0,
                   499.0, 1195.0, 906.0, 903.0, 593.0, 888.0, 602.0, 1079.0, 191.0, 155.0,
                   374.0, 192.0, -36.0, -304.0, -275.0, -368.0, -546.0, -193.0, 114.0, 310.0,
                   -214.0, 37.0, 466.0, 221.0, 399.0, 83.0, -16.0, 486.0, 414.0, 561.0, 567.0,
                   687.0, 312.0, 27.0, -54.0, -216.0, 245.0, -101.0, 58.0, -146.0, -114.0,
                   555.0, 164.0, 406.0, 98.0, -1.0, 78.0, -185.0, -271.0, -398.0, -35.0, 115.0,
                   435.0, -194.0, 8.0, 429.0, 106.0, 480.0, 326.0, 1264.0, 1412.0, 1168.0,
                   949.0, 1335.0, 1056.0, 1203.0, 1219.0, 1189.0, 1491.0, 850.0, 1002.0,
                   1078.0, 678.0, 993.0, 986.0, 549.0, 524.0, 234.0, 451.0, 58.0, -16.0,
                   -249.0, -419.0, -67.0, -411.0, -239.0, -559.0, -498.0, -168.0, -66.0,
                   -180.0, -389.0, -183.0, 112.0, -20.0, 373.0, -98.0, -200.0, -274.0, 137.0,
                   -744.0, -460.0, -356.0, -596.0, -311.0, -363.0, -598.0, -806.0, -1045.0,
                   -1044.0, -1168.0, -540.0, -786.0, -1222.0, -819.0, -931.0, -781.0, -362.0,
                   -690.0, -637.0, -489.0, -679.0, -335.0, -166.0, -139.0, -101.0, -209.0,
                   198.0, 82.0, -246.0, -136.0, -318.0, -288.0, -485.0, -307.0, -348.0, -95.0,
                   -327.0, -281.0, -89.0, -371.0, 483.0, -68.0, 67.0, 57.0, 672.0, 578.0,
                   782.0, 758.0, 585.0, 1118.0, 788.0, 1159.0, 489.0, 855.0, 1082.0, 1114.0,
                   980.0, 1194.0, 1070.0, 625.0, 1102.0, 948.0, 1230.0, 582.0, 392.0, 738.0,
                   313.0, -18.0, 475.0, 227.0, -66134.0, 16313.0};
        bias = -286.0f;
        num_features = 502;
    }

    int classify(const std::vector<uint16_t> &input)
    {
        float linear_sum = bias;
        for (size_t i = 0; i < num_features; ++i)
        {
            linear_sum += static_cast<uint16_t>(input[i]) * weights[i];
        }
        return (linear_sum > 0.0f) ? 1 : 0;
    }
};

int main()
{
    Perceptron perceptron;
    std::vector<uint16_t> input = {951,
                                   951,
                                   890,
                                   879,
                                   863,
                                   861,
                                   775,
                                   721,
                                   691,
                                   688,
                                   638,
                                   620,
                                   638,
                                   656,
                                   574,
                                   579,
                                   592,
                                   564,
                                   555,
                                   502,
                                   563,
                                   528,
                                   534,
                                   482,
                                   438,
                                   481,
                                   467,
                                   474,
                                   456,
                                   453,
                                   439,
                                   442,
                                   435,
                                   398,
                                   427,
                                   448,
                                   450,
                                   438,
                                   443,
                                   432,
                                   436,
                                   418,
                                   468,
                                   400,
                                   403,
                                   432,
                                   370,
                                   407,
                                   439,
                                   435,
                                   458,
                                   455,
                                   535,
                                   563,
                                   576,
                                   561,
                                   592,
                                   585,
                                   598,
                                   592,
                                   624,
                                   698,
                                   752,
                                   758,
                                   725,
                                   823,
                                   809,
                                   806,
                                   818,
                                   865,
                                   870,
                                   867,
                                   878,
                                   880,
                                   987,
                                   946,
                                   874,
                                   899,
                                   903,
                                   898,
                                   902,
                                   907,
                                   895,
                                   903,
                                   912,
                                   900,
                                   935,
                                   933,
                                   912,
                                   988,
                                   913,
                                   917,
                                   909,
                                   947,
                                   802,
                                   775,
                                   755,
                                   727,
                                   754,
                                   738,
                                   743,
                                   755,
                                   704,
                                   630,
                                   559,
                                   587,
                                   559,
                                   535,
                                   507,
                                   451,
                                   479,
                                   463,
                                   476,
                                   460,
                                   399,
                                   434,
                                   386,
                                   425,
                                   416,
                                   500,
                                   372,
                                   415,
                                   425,
                                   387,
                                   419,
                                   403,
                                   400,
                                   415,
                                   417,
                                   397,
                                   395,
                                   402,
                                   380,
                                   384,
                                   369,
                                   346,
                                   401,
                                   400,
                                   418,
                                   399,
                                   418,
                                   412,
                                   423,
                                   380,
                                   448,
                                   462,
                                   487,
                                   483,
                                   576,
                                   619,
                                   629,
                                   648,
                                   658,
                                   711,
                                   743,
                                   755,
                                   752,
                                   813,
                                   826,
                                   816,
                                   826,
                                   805,
                                   884,
                                   839,
                                   844,
                                   885,
                                   894,
                                   846,
                                   895,
                                   824,
                                   896,
                                   853,
                                   881,
                                   830,
                                   906,
                                   896,
                                   854,
                                   883,
                                   878,
                                   889,
                                   874,
                                   914,
                                   904,
                                   897,
                                   890,
                                   892,
                                   880,
                                   891,
                                   848,
                                   816,
                                   724,
                                   673,
                                   640,
                                   619,
                                   578,
                                   539,
                                   547,
                                   543,
                                   495,
                                   477,
                                   478,
                                   432,
                                   437,
                                   410,
                                   430,
                                   413,
                                   419,
                                   399,
                                   422,
                                   410,
                                   438,
                                   446,
                                   400,
                                   342,
                                   411,
                                   427,
                                   368,
                                   384,
                                   322,
                                   370,
                                   381,
                                   368,
                                   354,
                                   369,
                                   383,
                                   371,
                                   375,
                                   368,
                                   370,
                                   431,
                                   378,
                                   382,
                                   378,
                                   411,
                                   401,
                                   417,
                                   464,
                                   511,
                                   773,
                                   746,
                                   773,
                                   787,
                                   785,
                                   848,
                                   832,
                                   816,
                                   848,
                                   862,
                                   835,
                                   873,
                                   863,
                                   864,
                                   862,
                                   915,
                                   934,
                                   905,
                                   955,
                                   889,
                                   912,
                                   893,
                                   893,
                                   883,
                                   912,
                                   907,
                                   869,
                                   899,
                                   880,
                                   770,
                                   786,
                                   683,
                                   624,
                                   672,
                                   611,
                                   573,
                                   561,
                                   532,
                                   505,
                                   492,
                                   549,
                                   464,
                                   432,
                                   458,
                                   445,
                                   458,
                                   511,
                                   432,
                                   430,
                                   422,
                                   401,
                                   416,
                                   409,
                                   403,
                                   390,
                                   429,
                                   419,
                                   400,
                                   400,
                                   384,
                                   395,
                                   383,
                                   425,
                                   402,
                                   379,
                                   368,
                                   407,
                                   368,
                                   373,
                                   343,
                                   380,
                                   342,
                                   446,
                                   359,
                                   347,
                                   416,
                                   430,
                                   447,
                                   456,
                                   510,
                                   464,
                                   614,
                                   618,
                                   613,
                                   595,
                                   631,
                                   623,
                                   642,
                                   713,
                                   730,
                                   753,
                                   751,
                                   835,
                                   802,
                                   769,
                                   805,
                                   845,
                                   847,
                                   858,
                                   849,
                                   867,
                                   880,
                                   880,
                                   880,
                                   877,
                                   886,
                                   890,
                                   860,
                                   883,
                                   869,
                                   899,
                                   907,
                                   941,
                                   850,
                                   894,
                                   912,
                                   931,
                                   878,
                                   847,
                                   847,
                                   828,
                                   757,
                                   633,
                                   640,
                                   625,
                                   617,
                                   601,
                                   635,
                                   642,
                                   576,
                                   529,
                                   539,
                                   499,
                                   500,
                                   464,
                                   448,
                                   407,
                                   447,
                                   463,
                                   431,
                                   421,
                                   405,
                                   390,
                                   379,
                                   459,
                                   423,
                                   384,
                                   403,
                                   388,
                                   379,
                                   384,
                                   384,
                                   375,
                                   366,
                                   363,
                                   352,
                                   379,
                                   342,
                                   325,
                                   369,
                                   369,
                                   401,
                                   368,
                                   384,
                                   386,
                                   394,
                                   391,
                                   379,
                                   448,
                                   439,
                                   577,
                                   531,
                                   593,
                                   638,
                                   689,
                                   638,
                                   688,
                                   817,
                                   765,
                                   833,
                                   782,
                                   850,
                                   820,
                                   799,
                                   859,
                                   849,
                                   833,
                                   827,
                                   860,
                                   853,
                                   823,
                                   828,
                                   865,
                                   874,
                                   857,
                                   897,
                                   854,
                                   865,
                                   908,
                                   896,
                                   885,
                                   907,
                                   894,
                                   884,
                                   902,
                                   897,
                                   892,
                                   880,
                                   893,
                                   855,
                                   765,
                                   761,
                                   708,
                                   704,
                                   642,
                                   617,
                                   577,
                                   560,
                                   522,
                                   490,
                                   482,
                                   447,
                                   460,
                                   451,
                                   431,
                                   433,
                                   444,
                                   446,
                                   403,
                                   439,
                                   407,
                                   390,
                                   397,
                                   394,
                                   383,
                                   384,
                                   356,
                                   393,
                                   368,
                                   368,
                                   372,
                                   379,
                                   363,
                                   357,
                                   364,
                                   368,
                                   369,
                                   362,
                                   370,
                                   356,
                                   418,
                                   364,
                                   359,
                                   361,
                                   354,
                                   385,
                                   410,
                                   422,
                                   423,
                                   454,
                                   551,
                                   592};

    uint16_t maximum = 0;
    uint16_t minimum = 4096;

    for (int i = 0; i < 500; i++)
    {
        if (input[i] > maximum)
        {
            maximum = input[i];
        }
        else if (input[i] < minimum)
        {
            minimum = input[i];
        }
    }

    std::cout << "Maximum: " << maximum << std::endl;
    std::cout << "Minimum: " << minimum << std::endl;

    input.push_back(maximum);
    input.push_back(minimum);

    int result = perceptron.classify(input);
    std::cout << "Classification result: " << result << std::endl;

    return 0;
}
